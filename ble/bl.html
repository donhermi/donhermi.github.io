<script> 
// Validate services UUID entered by user first.

    navigator.bluetooth.requestDevice({
     // filters: [...] <- Prefer filters to save energy & show relevant devices.
        acceptAllDevices: true,
        optionalServices: optionalServices})
    .then(device => {
      return device.gatt.connect();
    })
    .then(server => {
      // Note that we could also get all services that match a specific UUID by
      // passing it to getPrimaryServices().
      return server.getPrimaryServices();
    })
    .then(services => {

      let queue = Promise.resolve();
      services.forEach(service => {
        queue = queue.then(_ => service.getCharacteristics().then(characteristics => {

          characteristics.forEach(characteristic => {

                getSupportedProperties(characteristic);
          });
        }));
      });
      return queue;
    })
    .catch(error => {

    });
  
  
  /* Utils */
  
  function getSupportedProperties(characteristic) {
    let supportedProperties = [];
    for (const p in characteristic.properties) {
      if (characteristic.properties[p] === true) {
        supportedProperties.push(p.toUpperCase());
      }
    }
    return '[' + supportedProperties.join(', ') + ']';
  
  }


</script>